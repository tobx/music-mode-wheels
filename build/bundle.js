var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function a(e,t,n){e.$$.on_destroy.push(s(t,n))}function l(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function d(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function p(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function m(e){return document.createTextNode(e)}function h(){return m(" ")}function g(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function b(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function $(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function w(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function y(e,t,n){e.classList[n?"add":"remove"](t)}let v;function x(e){v=e}function k(){if(!v)throw new Error("Function called outside component initialization");return v}function P(){const e=k();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach((t=>{t.call(e,o)}))}}}const C=[],j=[],O=[],_=[],M=Promise.resolve();let A=!1;function E(e){O.push(e)}function D(e){_.push(e)}let L=!1;const S=new Set;function B(){if(!L){L=!0;do{for(let e=0;e<C.length;e+=1){const t=C[e];x(t),I(t.$$)}for(x(null),C.length=0;j.length;)j.pop()();for(let e=0;e<O.length;e+=1){const t=O[e];S.has(t)||(S.add(t),t())}O.length=0}while(C.length);for(;_.length;)_.pop()();A=!1,L=!1,S.clear()}}function I(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(E)}}const N=new Set;let z;function G(e,t){e&&e.i&&(N.delete(e),e.i(t))}function T(e,t,n,r){if(e&&e.o){if(N.has(e))return;N.add(e),z.c.push((()=>{N.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function R(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function F(e){e&&e.c()}function H(e,n,i,s){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=e.$$;a&&a.m(n,i),s||E((()=>{const n=l.map(t).filter(o);c?c.push(...n):r(n),e.$$.on_mount=[]})),u.forEach(E)}function W(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function q(e,t){-1===e.$$.dirty[0]&&(C.push(e),A||(A=!0,M.then(B)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function U(t,o,i,s,a,l,c=[-1]){const d=v;x(t);const f=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:c,skip_bound:!1};let p=!1;if(f.ctx=i?i(t,o.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&a(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),p&&q(t,e)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!s&&s(f.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);f.fragment&&f.fragment.l(e),e.forEach(u)}else f.fragment&&f.fragment.c();o.intro&&G(t.$$.fragment),H(t,o.target,o.anchor,o.customElement),B()}x(d)}class Z{$destroy(){W(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var V;const J=null!==(V=window.AudioContext)&&void 0!==V?V:window.webkitAudioContext;function K(){if(void 0===J)throw new Error("AudioContext is not supported.");return new J}class Q{constructor(){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:K()})}async decode(e){return new Promise(((t,n)=>{this.context.decodeAudioData(e,t,n)}))}}async function X(e){await new Promise((t=>e.addEventListener("ended",t)))}class Y{constructor(){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:K()}),Object.defineProperty(this,"gainNode",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sources",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),this.gainNode=this.createGain()}get currentTime(){return this.context.currentTime}createGain(){const e=this.context.createGain();return e.connect(this.context.destination),e}async stop(e=.04,t=-96,n=.01){const r=this.context.currentTime+n,o=r+e,i=20*e/(t*-Math.log(10));this.gainNode.gain.setTargetAtTime(0,r,i),this.gainNode=this.createGain();const s=[...this.sources].map((async e=>{e.stop(o),await X(e)}));await Promise.all(s)}async play(e,t,n,r){const o=this.context.createBufferSource();o.buffer=e,o.connect(this.gainNode),this.sources.add(o),o.start(t,n,r),await X(o),this.sources.delete(o),o.disconnect()}}function ee(e,t){return"/"===e.slice(-1)?e+t:e+"/"+t}const te=[];function ne(t,n=e){let r;const o=[];function s(e){if(i(t,e)&&(t=e,r)){const e=!te.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),te.push(n,t)}if(e){for(let e=0;e<te.length;e+=2)te[e][0](te[e+1]);te.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,a=e){const l=[i,a];return o.push(l),1===o.length&&(r=n(s)||e),i(t),()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}const re={instruments:{libraryUrl:"instruments",defaultPreset:{id:"piano",tempo:120},index:{piano:{name:"Piano",presets:[{tempo:60,path:"piano/500ms"},{tempo:120,path:"piano/250ms"}]},vibraphone:{name:"Vibraphone",presets:[{tempo:60,path:"vibraphone/500ms"},{tempo:120,path:"vibraphone/250ms"}]}}}},oe=new class{constructor(e,t){Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"decoder",{enumerable:!0,configurable:!0,writable:!0,value:new Q})}getUrl({id:e,tempo:t}){var n;const r=null===(n=this.index[e])||void 0===n?void 0:n.presets.find((({tempo:e})=>e===t));if(void 0===r){throw new Error(`Cannot find tempo '${t}' for instrument id '${e}'.`)}return ee(this.url,r.path)}get instruments(){return Object.keys(this.index).map((e=>this.getInstrument(e)))}hasPreset({id:e,tempo:t}){var n;return null===(n=this.getInstrument(e))||void 0===n?void 0:n.tempi.includes(t)}getInstrument(e){if(this.index.hasOwnProperty(e)){const{name:t,presets:n}=this.index[e];return{id:e,name:t,tempi:n.map((e=>e.tempo))}}}async loadSamples(e){const t=this.getUrl(e),[n,r]=await Promise.all([this.loadSampleIndex(t),this.loadSampleFile(t)]);let o=0;const i=n.map((async({note:e,bytes:t})=>{const n=o+t,i=r.slice(o,n);return o=n,{note:e,buffer:await this.decoder.decode(i)}}));return Promise.all(i)}async loadSampleIndex(e){return(await fetch(ee(e,"index.json"))).json()}async loadSampleFile(e){return(await fetch(ee(e,"samples.bin"))).arrayBuffer()}}(re.instruments.libraryUrl,re.instruments.index),ie=new class{constructor(e,t=.01){Object.defineProperty(this,"library",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"latency",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"player",{enumerable:!0,configurable:!0,writable:!0,value:new Y}),Object.defineProperty(this,"buffers",{enumerable:!0,configurable:!0,writable:!0,value:{}})}async load(e){await this.unload();const t=await this.library.loadSamples(e);for(const{note:e,buffer:n}of t)this.buffers[e]=n}async playNote(e,t,n,r){const o=this.buffers[e];void 0!==o&&await this.player.play(o,t,n,r)}async playPattern(e){let t=this.player.currentTime+this.latency;const n=e.map((async({note:e,delay:n})=>{t+=n,await this.playNote(e,t)}));await Promise.all(n)}async stop(){await this.player.stop()}async unload(){this.buffers={},await this.stop()}}(oe),se=ne("initial"),{set:ae,update:le}=se,ce=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(se,["set","update"]),ue=ne(re.instruments.defaultPreset.id),de=ne(re.instruments.defaultPreset.tempo);(function(t,n,i){const a=!Array.isArray(t),l=a?[t]:t,c=n.length<2;return{subscribe:ne(i,(t=>{let i=!1;const u=[];let d=0,f=e;const p=()=>{if(d)return;f();const r=n(a?u[0]:u,t);c?t(r):f=o(r)?r:e},m=l.map(((e,t)=>s(e,(e=>{u[t]=e,d&=~(1<<t),i&&p()}),(()=>{d|=1<<t}))));return i=!0,p(),function(){r(m),f()}})).subscribe}})([ue,de],(([e,t])=>({id:e,tempo:t}))).subscribe((async e=>{if(oe.hasPreset(e))ae("loading"),await ie.load(e),ae("loaded");else{const t=oe.getInstrument(e.id);if(void 0===t)throw new Error("Cannot find instrument with id: "+e.id);de.set(t.tempi[0])}}));const fe=async e=>{await ie.playPattern(e)},pe=async()=>{await ie.stop()},me=Math.PI/180;function he(e){return[`M 0 ${e}`,`a ${e} ${e} 0 0 1 0 ${-2*e}`,`a ${e} ${e} 0 0 1 0 ${2*e}`].join(" ")}function ge(e,t,n){const r=n*me,o=Math.cos(r),i=Math.sin(r);return[`M ${e} 0`,`A ${e} ${e} 0 0 1 ${o*e} ${i*e}`,`L ${o*t} ${i*t}`,`A ${t} ${t} 0 0 0 ${t} 0`,"Z"].join(" ")}function be(e,t,n){const r=e.slice();return r[11]=t[n],r[13]=n,r}function $e(e){let t,n,r,o,i,s,a,d,f,v,x,k,P,C,j=`${e[13]+1}. `,O=e[11].name+"";function _(){return e[8](e[11],e[13])}return{c(){t=p("g"),n=p("path"),r=p("text"),o=p("textPath"),i=p("tspan"),s=m(j),a=h(),d=p("tspan"),f=m(O),v=h(),x=p("circle"),b(n,"d",e[11].path),b(n,"transform","rotate(-90)"),b(n,"class","svelte-12ricdg"),b(i,"alignment-baseline","middle"),w(i,"font-size",ye+"px"),b(d,"alignment-baseline","middle"),w(d,"font-size",e[11].fontSize+"px"),b(o,"startOffset","50%"),$(o,"xlink:href","#mode-text-circle"),b(r,"text-anchor","middle"),b(r,"dominant-baseline","middle"),b(r,"transform","rotate(15)"),b(r,"class","svelte-12ricdg"),b(x,"cy",k=-e[0]),b(x,"r","5"),b(x,"transform","rotate(15)"),b(x,"class","svelte-12ricdg"),b(t,"class","mode svelte-12ricdg"),b(t,"transform","rotate("+e[11].rotation+")"),y(t,"selected",e[11]===e[1])},m(e,u){c(e,t,u),l(t,n),l(t,r),l(r,o),l(o,i),l(i,s),l(o,a),l(o,d),l(d,f),l(o,v),l(t,x),P||(C=g(t,"click",_),P=!0)},p(n,r){e=n,1&r&&k!==(k=-e[0])&&b(x,"cy",k),18&r&&y(t,"selected",e[11]===e[1])},d(e){e&&u(t),P=!1,C()}}}function we(t){let n,r,o,i,s,a=t[4],f=[];for(let e=0;e<a.length;e+=1)f[e]=$e(be(t,a,e));return{c(){n=p("defs"),r=p("path"),o=h(),i=p("g"),s=p("circle");for(let e=0;e<f.length;e+=1)f[e].c();b(r,"id","mode-text-circle"),b(r,"d",he(t[3])),b(s,"r",t[0]),b(s,"class","svelte-12ricdg"),b(i,"class","wheel svelte-12ricdg"),w(i,"transform","rotate("+t[2]+"deg)")},m(e,t){c(e,n,t),l(n,r),c(e,o,t),c(e,i,t),l(i,s);for(let e=0;e<f.length;e+=1)f[e].m(i,null)},p(e,[t]){if(1&t&&b(s,"r",e[0]),51&t){let n;for(a=e[4],n=0;n<a.length;n+=1){const r=be(e,a,n);f[n]?f[n].p(r,t):(f[n]=$e(r),f[n].c(),f[n].m(i,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=a.length}4&t&&w(i,"transform","rotate("+e[2]+"deg)")},i:e,o:e,d(e){e&&u(n),e&&u(o),e&&u(i),d(f,e)}}}const ye=8;function ve(e,t,n){let{outerRadius:r}=t,{innerRadius:o}=t,{modeDefs:i}=t;const s=P(),a=(r+o)/2;class l{constructor(e){Object.defineProperty(this,"def",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.path=ge(r,o,30)}get angle(){return-this.rotation}get fontSize(){return Math.min(ye,88/this.name.length)}get name(){return this.def.name}get rotation(){return 30*this.def.semitones}}const c=i.map((e=>new l(e)));function u(e,t){n(1,d=e),s("modeChanged",t)}let d=c[0],f=0;return e.$$set=e=>{"outerRadius"in e&&n(6,r=e.outerRadius),"innerRadius"in e&&n(0,o=e.innerRadius),"modeDefs"in e&&n(7,i=e.modeDefs)},e.$$.update=()=>{if(6&e.$$.dirty){const e=d.angle-f;n(2,f+=(e%360+540)%360-180)}},[o,d,f,a,c,u,r,i,(e,t)=>u(e,t)]}class xe extends Z{constructor(e){super(),U(this,e,ve,we,i,{outerRadius:6,innerRadius:0,modeDefs:7})}}function ke(e,t,n){const r=e.slice();return r[13]=t[n],r}function Pe(e){let t,n,r,o,i,s,a,d=e[13].displayName+"";function f(){return e[7](e[13])}return{c(){t=p("g"),n=p("path"),r=p("text"),o=p("textPath"),i=m(d),b(n,"d",e[13].path),b(n,"transform","rotate(-90)"),b(n,"class","svelte-zs6wzo"),b(o,"startOffset","50%"),b(o,"text-anchor","middle"),b(o,"alignment-baseline","middle"),$(o,"xlink:href","#key-text-circle"),b(r,"dominant-baseline","middle"),b(r,"transform","rotate("+e[13].textAngle+")"),b(r,"class","svelte-zs6wzo"),b(t,"class","key "+e[13].type+" svelte-zs6wzo"),b(t,"transform","rotate("+e[13].rotation+")"),y(t,"selected",e[13]===e[0])},m(e,u){c(e,t,u),l(t,n),l(t,r),l(r,o),l(o,i),s||(a=g(t,"click",f),s=!0)},p(n,r){e=n,49&r&&y(t,"selected",e[13]===e[0])},d(e){e&&u(t),s=!1,a()}}}function Ce(t){let n,r,o,i,s=t[5].concat(t[4]),a=[];for(let e=0;e<s.length;e+=1)a[e]=Pe(ke(t,s,e));return{c(){n=p("defs"),r=p("path"),o=h(),i=p("g");for(let e=0;e<a.length;e+=1)a[e].c();b(r,"id","key-text-circle"),b(r,"d",he(t[2])),b(i,"class","wheel"),w(i,"transform","rotate("+t[1]+"deg)")},m(e,t){c(e,n,t),l(n,r),c(e,o,t),c(e,i,t);for(let e=0;e<a.length;e+=1)a[e].m(i,null)},p(e,[t]){if(57&t){let n;for(s=e[5].concat(e[4]),n=0;n<s.length;n+=1){const r=ke(e,s,n);a[n]?a[n].p(r,t):(a[n]=Pe(r),a[n].c(),a[n].m(i,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=s.length}2&t&&w(i,"transform","rotate("+e[1]+"deg)")},i:e,o:e,d(e){e&&u(n),e&&u(o),e&&u(i),d(a,e)}}}function je(e,t,n){let{radius:r}=t;const o=P(),i=2/3*r,s=r/2,a=(r+i)/2-1;class l{constructor(e,t,n,o,a=30,l=15){Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"displayName",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"keyAngle",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"textAngle",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const c=this.isWhite?s:i;this.path=ge(r,c,a)}get angle(){return 15-this.rotation-this.textAngle}get isWhite(){return"white"===this.type}}function c(e){n(0,p=e),o("keyChanged",e.name)}const u=[new l("white","C","C",0,45,15),new l("black","Db","C♯ / D♭",30),new l("white","D","D",45,60,30),new l("black","Eb","D♯ / E♭",90),new l("white","E","E",105,45,30),new l("white","F","F",150,45,15),new l("black","Gb","F♯ / G♭",180),new l("white","G","G",195,60,30),new l("black","Ab","G♯ / A♭",240),new l("white","A","A",255,60,30),new l("black","Bb","A♯ / B♭",300),new l("white","B","B",315,45,30)],d=u.filter((e=>!e.isWhite)),f=u.filter((e=>e.isWhite));let p=u[0],m=0;return e.$$set=e=>{"radius"in e&&n(6,r=e.radius)},e.$$.update=()=>{if(3&e.$$.dirty){const e=p.angle-m;n(1,m+=(e%360+540)%360-180)}},[p,m,a,c,d,f,r,e=>c(e)]}class Oe extends Z{constructor(e){super(),U(this,e,je,Ce,i,{radius:6})}}function _e(t){let n,r,o,i,s,a;return{c(){n=p("g"),r=p("circle"),o=p("path"),b(r,"cx","0"),b(r,"cy","0"),b(r,"r",t[0]),b(r,"fill","white"),b(r,"stroke","black"),b(r,"class","svelte-1k8n6k6"),b(o,"d",t[2]),b(o,"class","svelte-1k8n6k6"),b(n,"class",i="button "+t[1]+" svelte-1k8n6k6")},m(e,i){c(e,n,i),l(n,r),l(n,o),s||(a=g(n,"click",t[3]),s=!0)},p(e,[t]){1&t&&b(r,"r",e[0]),4&t&&b(o,"d",e[2]),2&t&&i!==(i="button "+e[1]+" svelte-1k8n6k6")&&b(n,"class",i)},i:e,o:e,d(e){e&&u(n),s=!1,a()}}}function Me(e){const t=2*Math.PI/3,n=Math.cos(t)*e,r=Math.sin(t)*e;return`M ${n} ${r} L ${e} 0 L ${n} ${-r} Z`}function Ae(e){const t=Math.sin(Math.PI/4)*e;return`M -${t} ${t} L ${t} ${t} L ${t} ${-t} L ${-t} ${-t} Z`}function Ee(e,t,n){let r,{radius:o}=t,{state:i}=t;const s=o/2;function a(e){return ge(2*e,1.75*e,180)}return e.$$set=e=>{"radius"in e&&n(0,o=e.radius),"state"in e&&n(1,i=e.state)},e.$$.update=()=>{2&e.$$.dirty&&n(2,r=("loading"===i?a:"playing"===i?Ae:Me)(s))},[o,i,r,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}class De extends Z{constructor(e){super(),U(this,e,Ee,_e,i,{radius:0,state:1})}}function Le(e){let t,n,r,o,i,s,a;return r=new De({props:{radius:e[4]/6,state:e[3]}}),r.$on("click",e[6]),i=new Oe({props:{radius:e[4]}}),i.$on("keyChanged",e[9]),s=new xe({props:{outerRadius:e[5],innerRadius:e[4],modeDefs:e[0]}}),s.$on("modeChanged",e[10]),{c(){t=p("svg"),n=p("g"),F(r.$$.fragment),o=p("g"),F(i.$$.fragment),F(s.$$.fragment),b(o,"transform","rotate(-15)"),b(n,"transform","translate("+Se/2+", "+Be/2+")"),b(t,"viewBox","0 0 "+Se+" "+Be),b(t,"class","svelte-1if29gr")},m(e,u){c(e,t,u),l(t,n),H(r,n,null),l(n,o),H(i,o,null),H(s,o,null),a=!0},p(e,[t]){const n={};8&t&&(n.state=e[3]),r.$set(n);const o={};1&t&&(o.modeDefs=e[0]),s.$set(o)},i(e){a||(G(r.$$.fragment,e),G(i.$$.fragment,e),G(s.$$.fragment,e),a=!0)},o(e){T(r.$$.fragment,e),T(i.$$.fragment,e),T(s.$$.fragment,e),a=!1},d(e){e&&u(t),W(r),W(i),W(s)}}}const Se=256,Be=256;function Ie(e,t,n){let r,o;a(e,ce,(e=>n(8,r=e))),a(e,de,(e=>n(11,o=e)));var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function a(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let{modeDefs:s}=t;const l=["G2 Ab2 A2 Bb2 B2 C3 Db3 D3 Eb3 E3 F3 Gb3","G3 Ab3 A3 Bb3 B3 C4 Db4 D4 Eb4 E4 F4 Gb4"].join(" ").split(" "),c=3*Math.min(Se,Be)/8,u=15*Math.min(Se,Be)/32;let d,f="C",p=0,m=!1;var h;h=()=>{},k().$$.on_mount.push(h);return e.$$set=e=>{"modeDefs"in e&&n(0,s=e.modeDefs)},e.$$.update=()=>{384&e.$$.dirty&&n(3,d="loaded"!==r?"loading":m?"playing":"stopped")},[s,f,p,d,c,u,function(){return i(this,void 0,void 0,(function*(){"loaded"===r&&(pe(),m||function(){i(this,void 0,void 0,(function*(){const e=60/o/2,t=[...s.slice(p),...s.slice(0,p)],r=t[0].semitones;let i=t.map((({semitones:e})=>(e+12-r)%12));i=[...i,12,...i.reverse()];const a=l.findIndex((e=>e.slice(0,-1)===f)),c=i.map(((t,n)=>({note:l[a+t],delay:0===n?0:e})));n(7,m=!0),yield fe(c),n(7,m=!1)}))}())}))},m,r,({detail:e})=>n(1,f=e),({detail:e})=>n(2,p=e)]}class Ne extends Z{constructor(e){super(),U(this,e,Ie,Le,i,{modeDefs:0})}}function ze(e,t,n){const r=e.slice();return r[4]=t[n].label,r[5]=t[n].value,r[6]=t[n].disabled,r}function Ge(e){let t,n,o,i,s,a,d,p,$,w=e[4]+"";return{c(){t=f("label"),n=f("input"),s=h(),a=m(w),d=h(),b(n,"type","radio"),n.disabled=o=e[6],n.__value=i=e[5],n.value=n.__value,b(n,"class","svelte-englqi"),e[3][0].push(n),b(t,"class","svelte-englqi"),y(t,"disabled",e[6])},m(r,o){c(r,t,o),l(t,n),n.checked=n.__value===e[0],l(t,s),l(t,a),l(t,d),p||($=[g(n,"change",e[2]),g(n,"click",Re)],p=!0)},p(e,r){2&r&&o!==(o=e[6])&&(n.disabled=o),2&r&&i!==(i=e[5])&&(n.__value=i,n.value=n.__value),1&r&&(n.checked=n.__value===e[0]),2&r&&w!==(w=e[4]+"")&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(a,w),2&r&&y(t,"disabled",e[6])},d(o){o&&u(t),e[3][0].splice(e[3][0].indexOf(n),1),p=!1,r($)}}}function Te(t){let n,r=t[1],o=[];for(let e=0;e<r.length;e+=1)o[e]=Ge(ze(t,r,e));return{c(){n=f("div");for(let e=0;e<o.length;e+=1)o[e].c();b(n,"class","group svelte-englqi")},m(e,t){c(e,n,t);for(let e=0;e<o.length;e+=1)o[e].m(n,null)},p(e,[t]){if(3&t){let i;for(r=e[1],i=0;i<r.length;i+=1){const s=ze(e,r,i);o[i]?o[i].p(s,t):(o[i]=Ge(s),o[i].c(),o[i].m(n,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},i:e,o:e,d(e){e&&u(n),d(o,e)}}}const Re=e=>e.currentTarget.focus();function Fe(e,t,n){let{group:r}=t,{options:o=[]}=t;return e.$$set=e=>{"group"in e&&n(0,r=e.group),"options"in e&&n(1,o=e.options)},[r,o,function(){r=this.__value,n(0,r)},[[]]]}class He extends Z{constructor(e){super(),U(this,e,Fe,Te,i,{group:0,options:1})}}function We(e){let t,n,r,o,i,s,a,d,p,m,g,$,w;function y(t){e[4](t)}let v={options:e[3]};function x(t){e[5](t)}void 0!==e[0]&&(v.group=e[0]),i=new He({props:v}),j.push((()=>R(i,"group",y)));let k={options:e[1]};return void 0!==e[2]&&(k.group=e[2]),g=new He({props:k}),j.push((()=>R(g,"group",x))),{c(){t=f("div"),n=f("div"),r=f("p"),r.textContent="Instrument:",o=h(),F(i.$$.fragment),a=h(),d=f("div"),p=f("p"),p.textContent="Tempo:",m=h(),F(g.$$.fragment),b(r,"class","name svelte-10kwvse"),b(n,"class","group svelte-10kwvse"),b(p,"class","name svelte-10kwvse"),b(d,"class","group svelte-10kwvse"),b(t,"class","options svelte-10kwvse")},m(e,s){c(e,t,s),l(t,n),l(n,r),l(n,o),H(i,n,null),l(t,a),l(t,d),l(d,p),l(d,m),H(g,d,null),w=!0},p(e,[t]){const n={};!s&&1&t&&(s=!0,n.group=e[0],D((()=>s=!1))),i.$set(n);const r={};2&t&&(r.options=e[1]),!$&&4&t&&($=!0,r.group=e[2],D((()=>$=!1))),g.$set(r)},i(e){w||(G(i.$$.fragment,e),G(g.$$.fragment,e),w=!0)},o(e){T(i.$$.fragment,e),T(g.$$.fragment,e),w=!1},d(e){e&&u(t),W(i),W(g)}}}function qe(e,t,n){let r,o,i;a(e,ue,(e=>n(0,o=e))),a(e,de,(e=>n(2,i=e)));const s=oe.instruments.map((({id:e,name:t})=>({value:e,label:t})));return e.$$.update=()=>{1&e.$$.dirty&&n(1,r=(()=>{const e=oe.instruments.map((({tempi:e})=>e)),t=[].concat(...e);return[...new Set(t)].map((e=>({value:e,label:e+" BPM",disabled:!oe.hasPreset({id:o,tempo:e})})))})())},[o,r,i,s,function(e){o=e,ue.set(o)},function(e){i=e,de.set(i)}]}class Ue extends Z{constructor(e){super(),U(this,e,qe,We,i,{})}}function Ze(e){return e.map((([e,t])=>({name:t,semitones:e})))}const Ve={melodic:{major:Ze([[0,"Ionian"],[2,"Dorian"],[4,"Phrygian"],[5,"Lydian"],[7,"Mixolydian"],[9,"Aeolian"],[11,"Locrian"]]),minor:Ze([[0,"Melodic minor"],[2,"Dorian ♭9"],[3,"Lydian aug."],[5,"Lydian ♭7"],[7,"Mixolydian ♭13"],[9,"Aeolian ♭5"],[11,"Altered"]])},harmonic:{major:Ze([[0,"Harmonic major"],[2,"Dorian ♭5"],[4,"Altered ♮5"],[5,"Lydian minor"],[7,"Mixolydian ♭9"],[8,"Lydian aug. ♯9"],[11,"Locrian 𝄫7"]]),minor:Ze([[0,"Harmonic minor"],[2,"Locrian ♮13"],[3,"Ionian aug."],[5,"Dorian ♯11"],[7,"Mixolydian ♭9 ♭13"],[8,"Lydian ♯2"],[11,"Altered ♭♭7"]])}};function Je(e,t,n){const r=e.slice();return r[1]=t[n].name,r[2]=t[n].defs,r}function Ke(t){let n,r,o,i,s,a,d,p,g=t[1]+"";return a=new Ne({props:{modeDefs:t[2]}}),{c(){n=f("h2"),r=m(g),o=m(" Modes"),i=h(),s=f("div"),F(a.$$.fragment),d=h(),b(n,"class","svelte-11p35pg"),b(s,"class","wheel svelte-11p35pg")},m(e,t){c(e,n,t),l(n,r),l(n,o),c(e,i,t),c(e,s,t),H(a,s,null),l(s,d),p=!0},p:e,i(e){p||(G(a.$$.fragment,e),p=!0)},o(e){T(a.$$.fragment,e),p=!1},d(e){e&&u(n),e&&u(i),e&&u(s),W(a)}}}function Qe(e){let t,n,o,i,s,a,p,m,g;p=new Ue({});let $=e[0],w=[];for(let t=0;t<$.length;t+=1)w[t]=Ke(Je(e,$,t));const y=e=>T(w[e],1,1,(()=>{w[e]=null}));return{c(){t=f("main"),n=f("h1"),n.textContent="Music Mode Wheels",o=h(),i=f("div"),s=f("h3"),s.textContent="Playback Options",a=h(),F(p.$$.fragment),m=h();for(let e=0;e<w.length;e+=1)w[e].c();b(n,"class","svelte-11p35pg"),b(s,"class","svelte-11p35pg"),b(t,"class","svelte-11p35pg")},m(e,r){c(e,t,r),l(t,n),l(t,o),l(t,i),l(i,s),l(i,a),H(p,i,null),l(t,m);for(let e=0;e<w.length;e+=1)w[e].m(t,null);g=!0},p(e,[n]){if(1&n){let o;for($=e[0],o=0;o<$.length;o+=1){const r=Je(e,$,o);w[o]?(w[o].p(r,n),G(w[o],1)):(w[o]=Ke(r),w[o].c(),G(w[o],1),w[o].m(t,null))}for(z={r:0,c:[],p:z},o=$.length;o<w.length;o+=1)y(o);z.r||r(z.c),z=z.p}},i(e){if(!g){G(p.$$.fragment,e);for(let e=0;e<$.length;e+=1)G(w[e]);g=!0}},o(e){T(p.$$.fragment,e),w=w.filter(Boolean);for(let e=0;e<w.length;e+=1)T(w[e]);g=!1},d(e){e&&u(t),W(p),d(w,e)}}}function Xe(e){return[[{name:"Melodic Major",defs:Ve.melodic.major},{name:"Melodic Minor",defs:Ve.melodic.minor},{name:"Harmonic Major",defs:Ve.harmonic.major},{name:"Harmonic Minor",defs:Ve.harmonic.minor}]]}class Ye extends Z{constructor(e){super(),U(this,e,Xe,Qe,i,{})}}function et(t){let n;return{c(){n=f("footer"),n.innerHTML='<p>Made with <span class="red svelte-mr5kkz">♥</span> by\n    <a href="https://www.tobx.de/">Tobx</a></p>',b(n,"class","svelte-mr5kkz")},m(e,t){c(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}class tt extends Z{constructor(e){super(),U(this,e,null,et,i,{})}}function nt(t){let n;return{c(){n=f("header"),n.innerHTML='<a href="https://github.com/tobx/music-mode-wheels" class="icon svelte-177i1aa"><svg viewBox="0 0 136 133" fill="currentColor"><path d="M67.867,0C30.388,0 0,30.387 0,67.875C0,97.863 19.446,123.3 46.417,132.279C49.813,132.9 51.05,130.804 51.05,129.004C51.05,127.396 50.992,123.125 50.958,117.463C32.079,121.563 28.096,108.363 28.096,108.363C25.008,100.525 20.558,98.438 20.558,98.438C14.396,94.225 21.025,94.308 21.025,94.308C27.838,94.792 31.421,101.304 31.421,101.304C37.475,111.675 47.308,108.679 51.175,106.946C51.792,102.558 53.542,99.567 55.483,97.871C40.413,96.158 24.567,90.333 24.567,64.325C24.567,56.917 27.213,50.858 31.554,46.112C30.854,44.396 28.525,37.496 32.217,28.15C32.217,28.15 37.917,26.325 50.883,35.108C56.296,33.604 62.104,32.85 67.875,32.825C73.638,32.85 79.446,33.604 84.867,35.108C97.825,26.325 103.513,28.15 103.513,28.15C107.217,37.496 104.888,44.396 104.188,46.112C108.538,50.858 111.167,56.917 111.167,64.325C111.167,90.4 95.296,96.138 80.175,97.817C82.613,99.912 84.783,104.054 84.783,110.387C84.783,119.458 84.7,126.779 84.7,129.004C84.7,130.821 85.921,132.933 89.367,132.271C116.317,123.275 135.746,97.854 135.746,67.875C135.746,30.387 105.354,0 67.867,0"></path></svg></a>',b(n,"class","svelte-177i1aa")},m(e,t){c(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}class rt extends Z{constructor(e){super(),U(this,e,null,nt,i,{})}}function ot(t){let n,r,o,i,s,a,d;return r=new rt({}),i=new Ye({}),a=new tt({}),{c(){n=f("div"),F(r.$$.fragment),o=h(),F(i.$$.fragment),s=h(),F(a.$$.fragment),b(n,"class","app svelte-60fphp")},m(e,t){c(e,n,t),H(r,n,null),l(n,o),H(i,n,null),l(n,s),H(a,n,null),d=!0},p:e,i(e){d||(G(r.$$.fragment,e),G(i.$$.fragment,e),G(a.$$.fragment,e),d=!0)},o(e){T(r.$$.fragment,e),T(i.$$.fragment,e),T(a.$$.fragment,e),d=!1},d(e){e&&u(n),W(r),W(i),W(a)}}}return new class extends Z{constructor(e){super(),U(this,e,null,ot,i,{})}}({target:document.body})}();
