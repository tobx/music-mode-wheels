var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function a(e,t,n){e.$$.on_destroy.push(s(t,n))}function l(e){return null==e?"":e}function c(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode.removeChild(e)}function f(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function p(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function m(e){return document.createTextNode(e)}function b(){return m(" ")}function g(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function $(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function y(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function v(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function x(e,t,n){e.classList[n?"add":"remove"](t)}let P;function j(e){P=e}function O(){if(!P)throw new Error("Function called outside component initialization");return P}function k(){const e=O();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach((t=>{t.call(e,i)}))}}}const C=[],_=[],E=[],A=[],M=Promise.resolve();let D=!1;function I(e){E.push(e)}function T(e){A.push(e)}let L=!1;const S=new Set;function B(){if(!L){L=!0;do{for(let e=0;e<C.length;e+=1){const t=C[e];j(t),N(t.$$)}for(j(null),C.length=0;_.length;)_.pop()();for(let e=0;e<E.length;e+=1){const t=E[e];S.has(t)||(S.add(t),t())}E.length=0}while(C.length);for(;A.length;)A.pop()();D=!1,L=!1,S.clear()}}function N(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(I)}}const G=new Set;let F;function z(){F={r:0,c:[],p:F}}function R(){F.r||r(F.c),F=F.p}function q(e,t){e&&e.i&&(G.delete(e),e.i(t))}function K(e,t,n,r){if(e&&e.o){if(G.has(e))return;G.add(e),F.c.push((()=>{G.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function H(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function U(e){e&&e.c()}function W(e,n,o,s){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=e.$$;a&&a.m(n,o),s||I((()=>{const n=l.map(t).filter(i);c?c.push(...n):r(n),e.$$.on_mount=[]})),u.forEach(I)}function Z(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function V(e,t){-1===e.$$.dirty[0]&&(C.push(e),D||(D=!0,M.then(B)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function J(t,i,o,s,a,l,c=[-1]){const u=P;j(t);const f=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:c,skip_bound:!1};let h=!1;if(f.ctx=o?o(t,i.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[e],f.ctx[e]=i)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](i),h&&V(t,e)),n})):[],f.update(),h=!0,r(f.before_update),f.fragment=!!s&&s(f.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);f.fragment&&f.fragment.l(e),e.forEach(d)}else f.fragment&&f.fragment.c();i.intro&&q(t.$$.fragment),W(t,i.target,i.anchor,i.customElement),B()}j(u)}class Q{$destroy(){Z(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function X(e,t,n){const r=e.slice();return r[4]=t[n].label,r[5]=t[n].value,r[6]=t[n].disabled,r}function Y(e){let t,n,i,o,s,a,l,f,p,w=e[4]+"";return{c(){t=h("label"),n=h("input"),s=b(),a=m(w),l=b(),$(n,"type","radio"),n.disabled=i=e[6],n.__value=o=e[5],n.value=n.__value,$(n,"class","svelte-1hi13zh"),e[3][0].push(n),$(t,"class","svelte-1hi13zh"),x(t,"disabled",e[6])},m(r,i){u(r,t,i),c(t,n),n.checked=n.__value===e[0],c(t,s),c(t,a),c(t,l),f||(p=[g(n,"change",e[2]),g(n,"click",te)],f=!0)},p(e,r){2&r&&i!==(i=e[6])&&(n.disabled=i),2&r&&o!==(o=e[5])&&(n.__value=o,n.value=n.__value),1&r&&(n.checked=n.__value===e[0]),2&r&&w!==(w=e[4]+"")&&y(a,w),2&r&&x(t,"disabled",e[6])},d(i){i&&d(t),e[3][0].splice(e[3][0].indexOf(n),1),f=!1,r(p)}}}function ee(t){let n,r=t[1],i=[];for(let e=0;e<r.length;e+=1)i[e]=Y(X(t,r,e));return{c(){n=h("div");for(let e=0;e<i.length;e+=1)i[e].c();$(n,"class","group svelte-1hi13zh")},m(e,t){u(e,n,t);for(let e=0;e<i.length;e+=1)i[e].m(n,null)},p(e,[t]){if(3&t){let o;for(r=e[1],o=0;o<r.length;o+=1){const s=X(e,r,o);i[o]?i[o].p(s,t):(i[o]=Y(s),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}},i:e,o:e,d(e){e&&d(n),f(i,e)}}}const te=e=>e.currentTarget.focus();function ne(e,t,n){let{group:r}=t,{options:i=[]}=t;return e.$$set=e=>{"group"in e&&n(0,r=e.group),"options"in e&&n(1,i=e.options)},[r,i,function(){r=this.__value,n(0,r)},[[]]]}class re extends Q{constructor(e){super(),J(this,e,ne,ee,o,{group:0,options:1})}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */const ie=[];function oe(t,n=e){let r;const i=[];function s(e){if(o(t,e)&&(t=e,r)){const e=!ie.length;for(let e=0;e<i.length;e+=1){const n=i[e];n[1](),ie.push(n,t)}if(e){for(let e=0;e<ie.length;e+=2)ie[e][0](ie[e+1]);ie.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(o,a=e){const l=[o,a];return i.push(l),1===i.length&&(r=n(s)||e),o(t),()=>{const e=i.indexOf(l);-1!==e&&i.splice(e,1),0===i.length&&(r(),r=null)}}}}async function se(e){return await new Promise((t=>{const n=window.requestAnimationFrame(t);null==e||e(n)}))}class ae{constructor(){Object.defineProperty(this,"update",{enumerable:!0,configurable:!0,writable:!0,value:e=>{}}),Object.defineProperty(this,"duration",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"startTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"requestId",{enumerable:!0,configurable:!0,writable:!0,value:0})}start(e){return this.startTime=window.performance.now(),this.duration=e,this.stop(),this.loop(),this.startTime}stop(){window.cancelAnimationFrame(this.requestId)}async loop(){const e=await se((e=>this.requestId=e))-this.startTime;e<this.duration?(this.update(e/this.duration),this.loop()):this.update(1)}}var le;const ce=null!==(le=window.AudioContext)&&void 0!==le?le:window.webkitAudioContext;function ue(){if(void 0===ce)throw new Error("AudioContext is not supported.");return new ce}class de{constructor(){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:ue()})}async decode(e){return new Promise(((t,n)=>{this.context.decodeAudioData(e,t,n)}))}}async function fe(e){await new Promise((t=>e.addEventListener("ended",t)))}class he{constructor(){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:ue()}),Object.defineProperty(this,"gainNode",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sources",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"timers",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),this.gainNode=this.createGain()}get currentTime(){return this.context.currentTime}createGain(){const e=this.context.createGain();return e.connect(this.context.destination),e}setTimer(e,t){const n=new pe(this.context,e);this.timers.add(n),n.start((()=>{this.timers.delete(n),t()}))}async stop(e=.04,t=-96,n=.01){this.timers.forEach((e=>e.stop())),this.timers.clear();const r=this.context.currentTime+n,i=r+e,o=20*e/(t*-Math.log(10));this.gainNode.gain.setTargetAtTime(0,r,o),this.gainNode=this.createGain();const s=[...this.sources].map((async e=>{e.stop(i),await fe(e)}));await Promise.all(s)}async play(e,t,n,r){const i=this.context.createBufferSource();i.buffer=e,i.connect(this.gainNode),this.sources.add(i),i.start(t,n,r),await fe(i),this.sources.delete(i),i.disconnect()}}class pe{constructor(e,t){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"when",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"requestId",{enumerable:!0,configurable:!0,writable:!0,value:0})}stop(){window.cancelAnimationFrame(this.requestId)}async start(e){for(this.stop();this.context.currentTime<this.when;)await se((e=>this.requestId=e));e()}}function me(e,t){return"/"===e.slice(-1)?e+t:e+"/"+t}var be={url:"instruments",index:{piano:{name:"Piano",presets:[{tempo:60,path:"piano/500ms"},{tempo:120,path:"piano/250ms"}]},vibraphone:{name:"Vibraphone",presets:[{tempo:60,path:"vibraphone/500ms"},{tempo:120,path:"vibraphone/250ms"}]}}},ge={id:"piano",tempo:120};const $e=new class{constructor(e,t){Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"decoder",{enumerable:!0,configurable:!0,writable:!0,value:new de})}getUrl({id:e,tempo:t}){var n;const r=null===(n=this.index[e])||void 0===n?void 0:n.presets.find((({tempo:e})=>e===t));if(void 0===r){throw new Error(`Cannot find tempo '${t}' for instrument id '${e}'.`)}return me(this.url,r.path)}get instruments(){return Object.keys(this.index).map((e=>this.getInstrument(e)))}hasPreset({id:e,tempo:t}){var n;return null===(n=this.getInstrument(e))||void 0===n?void 0:n.tempi.includes(t)}getInstrument(e){if(this.index.hasOwnProperty(e)){const{name:t,presets:n}=this.index[e];return{id:e,name:t,tempi:n.map((e=>e.tempo))}}}async loadSamples(e){const t=this.getUrl(e),[n,r]=await Promise.all([this.loadSampleIndex(t),this.loadSampleFile(t)]);let i=0;const o=n.map((async({note:e,bytes:t})=>{const n=i+t,o=r.slice(i,n);return i=n,{note:e,buffer:await this.decoder.decode(o)}}));return Promise.all(o)}async loadSampleIndex(e){return(await fetch(me(e,"index.json"))).json()}async loadSampleFile(e){return(await fetch(me(e,"samples.bin"))).arrayBuffer()}}(be.url,be.index),we=new class{constructor(e,t=.005){Object.defineProperty(this,"library",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"latency",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"player",{enumerable:!0,configurable:!0,writable:!0,value:new he}),Object.defineProperty(this,"buffers",{enumerable:!0,configurable:!0,writable:!0,value:{}})}async load(e){await this.unload();const t=await this.library.loadSamples(e);for(const{note:e,buffer:n}of t)this.buffers[e]=n}async playNote(e,t,n,r){const i=this.buffers[e];void 0!==i&&await this.player.play(i,t,n,r)}async playPattern(e,t){let n=this.player.currentTime+this.latency;const r=e.map((async({note:e,delay:r})=>{n+=r,void 0!==t&&this.player.setTimer(n,(()=>t(e))),void 0!==e&&await this.playNote(e,n)}));await Promise.all(r)}async stop(){await this.player.stop()}async unload(){this.buffers={},await this.stop()}}($e),ye=oe("initial"),{set:ve,update:xe}=ye,Pe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(ye,["set","update"]),je=oe(ge.id),Oe=oe(ge.tempo);(function(t,n,o){const a=!Array.isArray(t),l=a?[t]:t,c=n.length<2;return{subscribe:oe(o,(t=>{let o=!1;const u=[];let d=0,f=e;const h=()=>{if(d)return;f();const r=n(a?u[0]:u,t);c?t(r):f=i(r)?r:e},p=l.map(((e,t)=>s(e,(e=>{u[t]=e,d&=~(1<<t),o&&h()}),(()=>{d|=1<<t}))));return o=!0,h(),function(){r(p),f()}})).subscribe}})([je,Oe],(([e,t])=>({id:e,tempo:t}))).subscribe((async e=>{if($e.hasPreset(e))ve("loading"),await we.load(e),ve("loaded");else{const t=$e.getInstrument(e.id);if(void 0===t)throw new Error("Cannot find instrument with id: "+e.id);Oe.set(t.tempi[0])}}));const ke=new Set,Ce=async(e,t,n)=>{void 0!==n&&ke.add(n),await we.playPattern(e,t),void 0!==n&&ke.delete(n)},_e=async()=>{ke.forEach((e=>e())),ke.clear(),await we.stop()};function Ee(e){let t,n,r,i,o,s,a,l,f,p,m,g,w;function y(t){e[4](t)}let v={options:e[3]};function x(t){e[5](t)}void 0!==e[0]&&(v.group=e[0]),o=new re({props:v}),_.push((()=>H(o,"group",y)));let P={options:e[1]};return void 0!==e[2]&&(P.group=e[2]),m=new re({props:P}),_.push((()=>H(m,"group",x))),{c(){t=h("div"),n=h("div"),r=h("p"),r.textContent="Instrument:",i=b(),U(o.$$.fragment),a=b(),l=h("div"),f=h("p"),f.textContent="Tempo:",p=b(),U(m.$$.fragment),$(r,"class","name svelte-s5xc78"),$(n,"class","group svelte-s5xc78"),$(f,"class","name svelte-s5xc78"),$(l,"class","group svelte-s5xc78"),$(t,"class","options svelte-s5xc78")},m(e,s){u(e,t,s),c(t,n),c(n,r),c(n,i),W(o,n,null),c(t,a),c(t,l),c(l,f),c(l,p),W(m,l,null),w=!0},p(e,[t]){const n={};!s&&1&t&&(s=!0,n.group=e[0],T((()=>s=!1))),o.$set(n);const r={};2&t&&(r.options=e[1]),!g&&4&t&&(g=!0,r.group=e[2],T((()=>g=!1))),m.$set(r)},i(e){w||(q(o.$$.fragment,e),q(m.$$.fragment,e),w=!0)},o(e){K(o.$$.fragment,e),K(m.$$.fragment,e),w=!1},d(e){e&&d(t),Z(o),Z(m)}}}function Ae(e,t,n){let r,i,o;a(e,je,(e=>n(0,i=e))),a(e,Oe,(e=>n(2,o=e)));const s=$e.instruments.map((({id:e,name:t})=>({value:e,label:t})));return e.$$.update=()=>{1&e.$$.dirty&&n(1,r=(()=>{const e=$e.instruments.map((({tempi:e})=>e)),t=[].concat(...e);return[...new Set(t)].map((e=>({value:e,label:e+" BPM",disabled:!$e.hasPreset({id:i,tempo:e})})))})())},[i,r,o,s,function(e){i=e,je.set(i)},function(e){o=e,Oe.set(o)}]}class Me extends Q{constructor(e){super(),J(this,e,Ae,Ee,o,{})}}function De(e){const t=function(e){return e*e*e}(e),n=function(e){return--e*e*e+1}(e);return function(e,t,n){return e+n*(t-e)}(t,n,n)}function Ie(e){return e}const Te=Math.PI/180;function Le(e){return[`M 0 ${e}`,`a ${e} ${e} 0 0 1 0 ${-2*e}`,`a ${e} ${e} 0 0 1 0 ${2*e}`].join(" ")}function Se(e,t,n){const r=n*Te,i=Math.cos(r),o=Math.sin(r);return[`M ${e} 0`,`A ${e} ${e} 0 0 1 ${i*e} ${o*e}`,`L ${i*t} ${o*t}`,`A ${t} ${t} 0 0 0 ${t} 0`,"Z"].join(" ")}class Be{constructor(e,t,n,r="%"){if(Object.defineProperty(this,"from",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"to",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"parts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.parts=e.split(r),t.length!==n.length)throw new Error("'from' length ≠ 'to' length");if(t.length+1!==this.parts.length)throw new Error("placeholder count ≠ values count")}morph(e){return this.parts.reduce(((t,n,r)=>{const i=r-1,o=this.from[i],s=this.to[i];return t+(o+e*(s-o))+n}))}}class Ne{constructor(e,t,n){Object.defineProperty(this,"morpher",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"duration",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"update",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"ease",{enumerable:!0,configurable:!0,writable:!0,value:Ie}),Object.defineProperty(this,"loop",{enumerable:!0,configurable:!0,writable:!0,value:new ae}),Object.defineProperty(this,"position",{enumerable:!0,configurable:!0,writable:!0,value:0})}animate(e){const t=this.position,n=e-this.position,r=Math.abs(n)*this.duration;this.loop.update=e=>{this.position=t+this.ease(e)*n,this.triggerUpdate()},this.loop.start(r)}set(e){this.position=e,this.triggerUpdate()}triggerUpdate(){this.update(this.morpher.morph(this.position))}stop(){this.loop.stop()}}function Ge(e,t,n){const r=e.slice();return r[11]=t[n],r[13]=n,r}function Fe(e){let t,n,r,i,o,s,a,l,f,h,y,P,j,O,k=`${e[13]+1}. `,C=e[11].name+"";function _(){return e[8](e[11],e[13])}return{c(){t=p("g"),n=p("path"),r=p("text"),i=p("textPath"),o=p("tspan"),s=m(k),a=b(),l=p("tspan"),f=m(C),h=b(),y=p("circle"),$(n,"d",e[11].path),$(n,"transform","rotate(-90)"),$(n,"class","svelte-si4hew"),$(o,"alignment-baseline","middle"),v(o,"font-size",Re+"px"),$(l,"alignment-baseline","middle"),v(l,"font-size",e[11].fontSize+"px"),$(i,"startOffset","50%"),w(i,"xlink:href","#mode-text-circle"),$(r,"text-anchor","middle"),$(r,"dominant-baseline","middle"),$(r,"transform","rotate(15)"),$(r,"class","svelte-si4hew"),$(y,"cy",P=-e[0]),$(y,"r","5"),$(y,"transform","rotate(15)"),$(y,"class","svelte-si4hew"),$(t,"class","mode svelte-si4hew"),$(t,"transform","rotate("+e[11].rotation+")"),x(t,"selected",e[11]===e[1])},m(e,d){u(e,t,d),c(t,n),c(t,r),c(r,i),c(i,o),c(o,s),c(i,a),c(i,l),c(l,f),c(i,h),c(t,y),j||(O=g(t,"click",_),j=!0)},p(n,r){e=n,1&r&&P!==(P=-e[0])&&$(y,"cy",P),18&r&&x(t,"selected",e[11]===e[1])},d(e){e&&d(t),j=!1,O()}}}function ze(t){let n,r,i,o,s,a=t[4],l=[];for(let e=0;e<a.length;e+=1)l[e]=Fe(Ge(t,a,e));return{c(){n=p("defs"),r=p("path"),i=b(),o=p("g"),s=p("circle");for(let e=0;e<l.length;e+=1)l[e].c();$(r,"id","mode-text-circle"),$(r,"d",Le(t[3])),$(s,"r",t[0]),$(s,"class","svelte-si4hew"),$(o,"class","wheel svelte-si4hew"),v(o,"transform","rotate("+t[2]+"deg)")},m(e,t){u(e,n,t),c(n,r),u(e,i,t),u(e,o,t),c(o,s);for(let e=0;e<l.length;e+=1)l[e].m(o,null)},p(e,[t]){if(1&t&&$(s,"r",e[0]),51&t){let n;for(a=e[4],n=0;n<a.length;n+=1){const r=Ge(e,a,n);l[n]?l[n].p(r,t):(l[n]=Fe(r),l[n].c(),l[n].m(o,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=a.length}4&t&&v(o,"transform","rotate("+e[2]+"deg)")},i:e,o:e,d(e){e&&d(n),e&&d(i),e&&d(o),f(l,e)}}}const Re=8;function qe(e,t,n){let{outerRadius:r}=t,{innerRadius:i}=t,{modeDefs:o}=t;const s=k(),a=(r+i)/2;class l{constructor(e){Object.defineProperty(this,"def",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.path=Se(r,i,30)}get angle(){return-this.rotation}get fontSize(){return Math.min(Re,88/this.name.length)}get name(){return this.def.name}get rotation(){return 30*this.def.semitones}}const c=o.map((e=>new l(e)));function u(e,t){n(1,d=e),s("modeChanged",t)}let d=c[0],f=0;return e.$$set=e=>{"outerRadius"in e&&n(6,r=e.outerRadius),"innerRadius"in e&&n(0,i=e.innerRadius),"modeDefs"in e&&n(7,o=e.modeDefs)},e.$$.update=()=>{if(6&e.$$.dirty){const e=d.angle-f;n(2,f+=(e%360+540)%360-180)}},[i,d,f,a,c,u,r,o,(e,t)=>u(e,t)]}class Ke extends Q{constructor(e){super(),J(this,e,qe,ze,o,{outerRadius:6,innerRadius:0,modeDefs:7})}}function He(e,t,n){const r=e.slice();return r[16]=t[n],r}function Ue(e){let t,n,r,i,o,s,a,l=e[16].displayName+"";function f(){return e[10](e[16])}return{c(){t=p("g"),n=p("path"),r=p("text"),i=p("textPath"),o=m(l),$(n,"d",e[16].path),$(n,"transform","rotate(-90)"),$(n,"class","svelte-11ya5m9"),$(i,"startOffset","50%"),$(i,"text-anchor","middle"),$(i,"alignment-baseline","middle"),w(i,"xlink:href","#key-text-circle"),$(r,"dominant-baseline","middle"),$(r,"transform","rotate("+e[16].textAngle+")"),$(r,"class","svelte-11ya5m9"),$(t,"class","key "+e[16].type+" svelte-11ya5m9"),$(t,"transform","rotate("+e[16].rotation+")"),x(t,"pressed",!0===e[2][e[16].name]),x(t,"selected",e[16]===e[0])},m(e,l){u(e,t,l),c(t,n),c(t,r),c(r,i),c(i,o),s||(a=g(t,"click",f),s=!0)},p(n,r){e=n,100&r&&x(t,"pressed",!0===e[2][e[16].name]),97&r&&x(t,"selected",e[16]===e[0])},d(e){e&&d(t),s=!1,a()}}}function We(t){let n,r,i,o,s=t[6].concat(t[5]),a=[];for(let e=0;e<s.length;e+=1)a[e]=Ue(He(t,s,e));return{c(){n=p("defs"),r=p("path"),i=b(),o=p("g");for(let e=0;e<a.length;e+=1)a[e].c();$(r,"id","key-text-circle"),$(r,"d",Le(t[3])),$(o,"class","wheel"),v(o,"transform","rotate("+t[1]+"deg)")},m(e,t){u(e,n,t),c(n,r),u(e,i,t),u(e,o,t);for(let e=0;e<a.length;e+=1)a[e].m(o,null)},p(e,[t]){if(117&t){let n;for(s=e[6].concat(e[5]),n=0;n<s.length;n+=1){const r=He(e,s,n);a[n]?a[n].p(r,t):(a[n]=Ue(r),a[n].c(),a[n].m(o,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=s.length}2&t&&v(o,"transform","rotate("+e[1]+"deg)")},i:e,o:e,d(e){e&&d(n),e&&d(i),e&&d(o),f(a,e)}}}function Ze(e,t,n){let{radius:r}=t;const i=k();const o=2/3*r,s=r/2,a=(r+o)/2-1;class l{constructor(e,t,n,i,a=30,l=15){Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"displayName",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"keyAngle",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"textAngle",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const c=this.isWhite?s:o;this.path=Se(r,c,a)}get angle(){return 15-this.rotation-this.textAngle}get isWhite(){return"white"===this.type}}function c(e){n(0,p=e),i("keyChanged",e.name)}const u=[new l("white","C","C",0,45,15),new l("black","Db","C♯ / D♭",30),new l("white","D","D",45,60,30),new l("black","Eb","D♯ / E♭",90),new l("white","E","E",105,45,30),new l("white","F","F",150,45,15),new l("black","Gb","F♯ / G♭",180),new l("white","G","G",195,60,30),new l("black","Ab","G♯ / A♭",240),new l("white","A","A",255,60,30),new l("black","Bb","A♯ / B♭",300),new l("white","B","B",315,45,30)],d=u.filter((e=>!e.isWhite)),f=u.filter((e=>e.isWhite)),h={};let p=u[0],m=0;return e.$$set=e=>{"radius"in e&&n(7,r=e.radius)},e.$$.update=()=>{if(3&e.$$.dirty){const e=p.angle-m;n(1,m+=(e%360+540)%360-180)}},[p,m,h,a,c,d,f,r,function(e){n(2,h[e]=!0,h)},function(e){n(2,h[e]=!1,h)},e=>c(e)]}class Ve extends Q{constructor(e){super(),J(this,e,Ze,We,o,{radius:7,pressKey:8,releaseKey:9})}get pressKey(){return this.$$.ctx[8]}get releaseKey(){return this.$$.ctx[9]}}function Je(t){let n;return{c(){n=p("path"),$(n,"d",t[0]),$(n,"class","svelte-1xw9lbd")},m(e,t){u(e,n,t)},p(e,[t]){1&t&&$(n,"d",e[0])},i:e,o:e,d(e){e&&d(n)}}}function Qe(e,t,n){let{radius:r}=t,{state:i}=t,{animationDuration:o=250}=t,{animationEasing:s=De}=t;const a=function(e,t){const r=function(e){const t=2*Math.PI/3,n=Math.cos(t)*e,r=Math.sin(t)*e;return[n,r,e,0,e,0,n,-r]}(e),i=function(e){const t=Math.sin(Math.PI/4)*e;return[-t,t,t,t,t,-t,-t,-t]}(e),o=new Be("M % % L % % L % % L % % Z",r,i),a=new Ne(o,t,(e=>{n(0,l=e)}));return a.ease=s,a}(r,o);let l;return e.$$set=e=>{"radius"in e&&n(1,r=e.radius),"state"in e&&n(2,i=e.state),"animationDuration"in e&&n(3,o=e.animationDuration),"animationEasing"in e&&n(4,s=e.animationEasing)},e.$$.update=()=>{4&e.$$.dirty&&("loading"===i?a.set(0):a.animate("playing"===i?1:0))},[l,r,i,o,s]}class Xe extends Q{constructor(e){super(),J(this,e,Qe,Je,o,{radius:1,state:2,animationDuration:3,animationEasing:4})}}function Ye(e){let t,n;return t=new Xe({props:{radius:e[0]/2-1,state:e[1]}}),{c(){U(t.$$.fragment)},m(e,r){W(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.radius=e[0]/2-1),2&n&&(r.state=e[1]),t.$set(r)},i(e){n||(q(t.$$.fragment,e),n=!0)},o(e){K(t.$$.fragment,e),n=!1},d(e){Z(t,e)}}}function et(t){let n;return{c(){n=p("path"),$(n,"d",t[2]),$(n,"class","svelte-14h7w44")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function tt(e){let t,n,r,i,o,s,a,f;const h=[et,Ye],m=[];function b(e,t){return"loading"===e[1]?0:1}return r=b(e),i=m[r]=h[r](e),{c(){t=p("g"),n=p("circle"),i.c(),$(n,"cx","0"),$(n,"cy","0"),$(n,"r",e[0]),$(n,"fill","white"),$(n,"stroke","black"),$(n,"class","svelte-14h7w44"),$(t,"class",o=l(e[1])+" svelte-14h7w44")},m(i,o){u(i,t,o),c(t,n),m[r].m(t,null),s=!0,a||(f=g(t,"click",e[3]),a=!0)},p(e,[a]){(!s||1&a)&&$(n,"r",e[0]);let c=r;r=b(e),r===c?m[r].p(e,a):(z(),K(m[c],1,1,(()=>{m[c]=null})),R(),i=m[r],i?i.p(e,a):(i=m[r]=h[r](e),i.c()),q(i,1),i.m(t,null)),(!s||2&a&&o!==(o=l(e[1])+" svelte-14h7w44"))&&$(t,"class",o)},i(e){s||(q(i),s=!0)},o(e){K(i),s=!1},d(e){e&&d(t),m[r].d(),a=!1,f()}}}function nt(e,t,n){let{radius:r}=t,{state:i}=t,o=Se(r,.875*r,180);return e.$$set=e=>{"radius"in e&&n(0,r=e.radius),"state"in e&&n(1,i=e.state)},[r,i,o,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}class rt extends Q{constructor(e){super(),J(this,e,nt,tt,o,{radius:0,state:1})}}function it(e){let t,n,r,i,o,s,a;r=new rt({props:{radius:e[5]/6,state:e[4]}}),r.$on("click",e[7]);let l={radius:e[5]};return o=new Ve({props:l}),e[10](o),o.$on("keyChanged",e[11]),s=new Ke({props:{outerRadius:e[6],innerRadius:e[5],modeDefs:e[0]}}),s.$on("modeChanged",e[12]),{c(){t=p("svg"),n=p("g"),U(r.$$.fragment),i=p("g"),U(o.$$.fragment),U(s.$$.fragment),$(i,"transform","rotate(-15)"),$(n,"transform","translate("+ot/2+", "+st/2+")"),$(t,"viewBox","0 0 "+ot+" "+st),$(t,"class","svelte-1ubiuhk")},m(e,l){u(e,t,l),c(t,n),W(r,n,null),c(n,i),W(o,i,null),W(s,i,null),a=!0},p(e,[t]){const n={};16&t&&(n.state=e[4]),r.$set(n);o.$set({});const i={};1&t&&(i.modeDefs=e[0]),s.$set(i)},i(e){a||(q(r.$$.fragment,e),q(o.$$.fragment,e),q(s.$$.fragment,e),a=!0)},o(e){K(r.$$.fragment,e),K(o.$$.fragment,e),K(s.$$.fragment,e),a=!1},d(n){n&&d(t),Z(r),e[10](null),Z(o),Z(s)}}}const ot=256,st=256;function at(e){return e.slice(0,-1)}function lt(e,t,n){let r,i;a(e,Pe,(e=>n(9,r=e))),a(e,Oe,(e=>n(13,i=e)));var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};let{modeDefs:s}=t;const l=["G2 Ab2 A2 Bb2 B2 C3 Db3 D3 Eb3 E3 F3 Gb3","G3 Ab3 A3 Bb3 B3 C4 Db4 D4 Eb4 E4 F4 Gb4"].join(" ").split(" "),c=3*Math.min(ot,st)/8,u=15*Math.min(ot,st)/32;let d,f,h="C",p=0,m=!1;var b;b=()=>{},O().$$.on_mount.push(b);return e.$$set=e=>{"modeDefs"in e&&n(0,s=e.modeDefs)},e.$$.update=()=>{768&e.$$.dirty&&("loaded"===r?n(4,f=m?"playing":"stopped"):(m&&_e(),n(4,f="loading")))},[s,d,h,p,f,c,u,function(){return o(this,void 0,void 0,(function*(){if("loaded"===r){const e=m;_e(),e||function(){const e=60/i/2,t=(o=s,a=p,[...o.slice(a),...o.slice(0,a)]),r=t[0].semitones;var o,a;let c=t.map((({semitones:e})=>(e+12-r)%12));c=[...c,12,...c.reverse()];const u=l.findIndex((e=>at(e)===h)),f=c.map(((t,n)=>({note:l[u+t],delay:0===n?0:e})));f.push({delay:e}),function(e){n(8,m=!0);let t="";Ce(e,(e=>{d.releaseKey(t),void 0===e?n(8,m=!1):(t=at(e),d.pressKey(t))}),(()=>{d.releaseKey(t),n(8,m=!1)}))}(f)}()}}))},m,r,function(e){_[e?"unshift":"push"]((()=>{d=e,n(1,d)}))},({detail:e})=>n(2,h=e),({detail:e})=>n(3,p=e)]}class ct extends Q{constructor(e){super(),J(this,e,lt,it,o,{modeDefs:0})}}function ut(e){return e.map((([e,t])=>({name:t,semitones:e})))}var dt={melodic:{major:ut([[0,"Ionian"],[2,"Dorian"],[4,"Phrygian"],[5,"Lydian"],[7,"Mixolydian"],[9,"Aeolian"],[11,"Locrian"]]),minor:ut([[0,"Melodic minor"],[2,"Dorian ♭9"],[3,"Lydian aug."],[5,"Lydian ♭7"],[7,"Mixolydian ♭13"],[9,"Aeolian ♭5"],[11,"Altered"]])},harmonic:{major:ut([[0,"Harmonic major"],[2,"Dorian ♭5"],[4,"Altered ♮5"],[5,"Lydian minor"],[7,"Mixolydian ♭9"],[8,"Lydian aug. ♯9"],[11,"Locrian 𝄫7"]]),minor:ut([[0,"Harmonic minor"],[2,"Locrian ♮13"],[3,"Ionian aug."],[5,"Dorian ♯11"],[7,"Mixolydian ♭9 ♭13"],[8,"Lydian ♯2"],[11,"Altered ♭♭7"]])}};function ft(e,t,n){const r=e.slice();return r[2]=t[n].name,r[3]=t[n].defs,r}function ht(t){let n,r,i,o,s,a,l,f,p=t[2]+"";return a=new ct({props:{modeDefs:t[3]}}),{c(){n=h("h2"),r=m(p),i=m(" Modes"),o=b(),s=h("div"),U(a.$$.fragment),l=b(),$(n,"class","svelte-196j46k"),$(s,"class","wheel svelte-196j46k")},m(e,t){u(e,n,t),c(n,r),c(n,i),u(e,o,t),u(e,s,t),W(a,s,null),c(s,l),f=!0},p:e,i(e){f||(q(a.$$.fragment,e),f=!0)},o(e){K(a.$$.fragment,e),f=!1},d(e){e&&d(n),e&&d(o),e&&d(s),Z(a)}}}function pt(e){let t,n,r,i,o,s,a,l,p,g;l=new Me({});let w=e[1],v=[];for(let t=0;t<w.length;t+=1)v[t]=ht(ft(e,w,t));const x=e=>K(v[e],1,1,(()=>{v[e]=null}));return{c(){t=h("main"),n=h("h1"),r=m(e[0]),i=b(),o=h("div"),s=h("h3"),s.textContent="Playback Options",a=b(),U(l.$$.fragment),p=b();for(let e=0;e<v.length;e+=1)v[e].c();$(n,"class","svelte-196j46k"),$(s,"class","svelte-196j46k"),$(t,"class","svelte-196j46k")},m(e,d){u(e,t,d),c(t,n),c(n,r),c(t,i),c(t,o),c(o,s),c(o,a),W(l,o,null),c(t,p);for(let e=0;e<v.length;e+=1)v[e].m(t,null);g=!0},p(e,[n]){if((!g||1&n)&&y(r,e[0]),2&n){let r;for(w=e[1],r=0;r<w.length;r+=1){const i=ft(e,w,r);v[r]?(v[r].p(i,n),q(v[r],1)):(v[r]=ht(i),v[r].c(),q(v[r],1),v[r].m(t,null))}for(z(),r=w.length;r<v.length;r+=1)x(r);R()}},i(e){if(!g){q(l.$$.fragment,e);for(let e=0;e<w.length;e+=1)q(v[e]);g=!0}},o(e){K(l.$$.fragment,e),v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)K(v[e]);g=!1},d(e){e&&d(t),Z(l),f(v,e)}}}function mt(e,t,n){let{title:r}=t;const i=[{name:"Melodic Major",defs:dt.melodic.major},{name:"Melodic Minor",defs:dt.melodic.minor},{name:"Harmonic Major",defs:dt.harmonic.major},{name:"Harmonic Minor",defs:dt.harmonic.minor}];return e.$$set=e=>{"title"in e&&n(0,r=e.title)},[r,i]}class bt extends Q{constructor(e){super(),J(this,e,mt,pt,o,{title:0})}}function gt(t){let n;return{c(){n=h("footer"),n.innerHTML='<p>Made with <span class="red svelte-mr5kkz">♥</span> by\n    <a href="https://www.tobx.de/">Tobx</a></p>',$(n,"class","svelte-mr5kkz")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}class $t extends Q{constructor(e){super(),J(this,e,null,gt,o,{})}}function wt(t){let n;return{c(){n=h("header"),n.innerHTML='<div class="flex-1 svelte-1al10k3"><a href="https://github.com/tobx/music-mode-wheels" class="icon svelte-1al10k3"><svg viewBox="0 0 64 64" fill="currentColor"><path d="M31.997,-0C14.327,-0 0,14.327 0,32.001C0,46.139 9.168,58.132 21.884,62.366C23.485,62.658 24.069,61.67 24.069,60.822C24.069,60.063 24.041,58.05 24.025,55.38C15.124,57.313 13.246,51.09 13.246,51.09C11.791,47.394 9.693,46.41 9.693,46.41C6.787,44.424 9.913,44.463 9.913,44.463C13.125,44.691 14.814,47.762 14.814,47.762C17.668,52.651 22.304,51.239 24.127,50.422C24.418,48.353 25.243,46.943 26.159,46.143C19.053,45.336 11.582,42.589 11.582,30.327C11.582,26.834 12.83,23.978 14.877,21.741C14.547,20.931 13.449,17.678 15.189,13.272C15.189,13.272 17.877,12.411 23.99,16.553C26.542,15.843 29.28,15.488 32.001,15.476C34.718,15.488 37.456,15.843 40.012,16.553C46.121,12.411 48.803,13.272 48.803,13.272C50.549,17.678 49.451,20.931 49.121,21.741C51.172,23.978 52.412,26.834 52.412,30.327C52.412,42.621 44.929,45.326 37.8,46.118C38.949,47.106 39.973,49.058 39.973,52.044C39.973,56.321 39.933,59.772 39.933,60.822C39.933,61.678 40.509,62.674 42.134,62.362C54.84,58.12 64,46.135 64,32.001C64,14.327 49.671,-0 31.997,-0"></path></svg></a></div> \n  <div class="center svelte-1al10k3"><strong class="svelte-1al10k3">No sound?</strong> \n    <span class="svelte-1al10k3">Check if your device is silenced.</span></div> \n  <div class="flex-1 svelte-1al10k3"></div>',$(n,"class","svelte-1al10k3")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}class yt extends Q{constructor(e){super(),J(this,e,null,wt,o,{})}}function vt(t){let n,r,i,o,s,a,l;return r=new yt({}),o=new bt({props:{title:t[0]}}),a=new $t({}),{c(){n=h("div"),U(r.$$.fragment),i=b(),U(o.$$.fragment),s=b(),U(a.$$.fragment),$(n,"class","app svelte-xkr4hx")},m(e,t){u(e,n,t),W(r,n,null),c(n,i),W(o,n,null),c(n,s),W(a,n,null),l=!0},p:e,i(e){l||(q(r.$$.fragment,e),q(o.$$.fragment,e),q(a.$$.fragment,e),l=!0)},o(e){K(r.$$.fragment,e),K(o.$$.fragment,e),K(a.$$.fragment,e),l=!1},d(e){e&&d(n),Z(r),Z(o),Z(a)}}}function xt(e){return[document.title]}return new class extends Q{constructor(e){super(),J(this,e,xt,vt,o,{})}}({target:document.body})}();
